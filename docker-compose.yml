version: '3.1'

networks:
  main:

# set build to '.' to make local mods

services:
  nginx-ocfl:
    build: mikelynch/nginx-ocfl:v1.1.0-beta
    ports:
      - "8080:8080"
    expose:
      - "8080"
    networks:
      - main
    volumes:
      - "./test_repos/:/etc/share/nginx/html/ocfl"
      - "../peppermint-portal/build/peppermint/:/etc/share/nginx/html/peppermint"

  solr:
    image: solr
    ports:
      - "8983:8983"
    expose:
      - "8983"
    networks:
      - main
    volumes:
      - "./test_solr/:/opt/solr/server/solr/ocflcore"
    command: solr-precreate ocflcore

